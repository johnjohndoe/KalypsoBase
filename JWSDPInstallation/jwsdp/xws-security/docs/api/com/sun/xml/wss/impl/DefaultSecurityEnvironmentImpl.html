<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN""http://www.w3.org/TR/REC-html40/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Mon May 24 14:15:06 PDT 2004 -->
<TITLE>
DefaultSecurityEnvironmentImpl (XWS-Security 1.0 EA3 (Early Access))
</TITLE>
<META NAME="keywords" CONTENT="com.sun.xml.wss.impl.DefaultSecurityEnvironmentImpl,DefaultSecurityEnvironmentImpl class">
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">
</HEAD>
<SCRIPT>
function asd()
{
parent.document.title="DefaultSecurityEnvironmentImpl (XWS-Security 1.0 EA3 (Early Access))";
}
</SCRIPT>
<BODY BGCOLOR="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/sun/xml/wss/impl/ContainerSecurityEnvironment.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.NonceReclaimer.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="DefaultSecurityEnvironmentImpl.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../../../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.sun.xml.wss.impl</FONT>
<BR>
Class DefaultSecurityEnvironmentImpl</H2>
<PRE>
java.lang.Object
  |
  +--<B>com.sun.xml.wss.impl.DefaultSecurityEnvironmentImpl</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></DD>
</DL>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../../../../com/sun/xml/wss/impl/ContainerSecurityEnvironment.html">ContainerSecurityEnvironment</A>, <A HREF="../../../../../com/sun/xml/wss/impl/TomcatSecurityEnvironment.html">TomcatSecurityEnvironment</A></DD>
</DL>
<HR>
<DL>
<DT>public class <B>DefaultSecurityEnvironmentImpl</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></DL>

<P>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->

<A NAME="nested_class_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Nested Class Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.NonceReclaimer.html">DefaultSecurityEnvironmentImpl.NonceReclaimer</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Field Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;java.util.logging.Logger</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#log">log</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logger</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#TIMESTAMP_FRESHNESS_LIMIT">TIMESTAMP_FRESHNESS_LIMIT</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#DefaultSecurityEnvironmentImpl(java.io.InputStream, java.lang.String, java.lang.String)">DefaultSecurityEnvironmentImpl</A></B>(java.io.InputStream&nbsp;trustStoreStream,
                               java.lang.String&nbsp;truststorePassword,
                               java.lang.String&nbsp;truststoreType)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor that initializes a Subject using
 AccessController.getContext()</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#DefaultSecurityEnvironmentImpl(java.io.InputStream, java.lang.String, java.lang.String, java.io.InputStream, java.lang.String, java.lang.String, java.lang.String[], java.lang.String[])">DefaultSecurityEnvironmentImpl</A></B>(java.io.InputStream&nbsp;keyStoreStream,
                               java.lang.String&nbsp;keystorePassword,
                               java.lang.String&nbsp;keystoreType,
                               java.io.InputStream&nbsp;trustStoreStream,
                               java.lang.String&nbsp;truststorePassword,
                               java.lang.String&nbsp;truststoreType,
                               java.lang.String[]&nbsp;aliases,
                               java.lang.String[]&nbsp;keyPasswords)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor that initializes a Subject, apart from the keystore and
 truststore</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String)">DefaultSecurityEnvironmentImpl</A></B>(java.lang.String&nbsp;truststoreURL,
                               java.lang.String&nbsp;truststorePassword)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor that initializes a Subject using
 AccessController.getContext().</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String)">DefaultSecurityEnvironmentImpl</A></B>(java.lang.String&nbsp;truststoreURL,
                               java.lang.String&nbsp;truststorePassword,
                               java.lang.String&nbsp;truststoreType)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor that initializes a Subject using
 AccessController.getContext()</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String)">DefaultSecurityEnvironmentImpl</A></B>(java.lang.String&nbsp;keystoreURL,
                               java.lang.String&nbsp;keystorePassword,
                               java.lang.String&nbsp;truststoreURL,
                               java.lang.String&nbsp;truststorePassword,
                               java.lang.String&nbsp;keyPassword)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor that initializes a Subject, apart from the keystore and
 truststore.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String[], java.lang.String[])">DefaultSecurityEnvironmentImpl</A></B>(java.lang.String&nbsp;keystoreURL,
                               java.lang.String&nbsp;keystorePassword,
                               java.lang.String&nbsp;truststoreURL,
                               java.lang.String&nbsp;truststorePassword,
                               java.lang.String[]&nbsp;aliases,
                               java.lang.String[]&nbsp;keyPasswords)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor that initializes a Subject, apart from the keystore and
 truststore.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String[], java.lang.String[])">DefaultSecurityEnvironmentImpl</A></B>(java.lang.String&nbsp;keystoreURL,
                               java.lang.String&nbsp;keystorePassword,
                               java.lang.String&nbsp;keystoreType,
                               java.lang.String&nbsp;truststoreURL,
                               java.lang.String&nbsp;truststorePassword,
                               java.lang.String&nbsp;truststoreType,
                               java.lang.String[]&nbsp;aliases,
                               java.lang.String[]&nbsp;keyPasswords)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor that initializes a Subject, apart from the keystore and
 truststore</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.util.Properties)">DefaultSecurityEnvironmentImpl</A></B>(java.lang.String&nbsp;keystoreURL,
                               java.lang.String&nbsp;keystorePassword,
                               java.lang.String&nbsp;keystoreType,
                               java.lang.String&nbsp;truststoreURL,
                               java.lang.String&nbsp;truststorePassword,
                               java.lang.String&nbsp;truststoreType,
                               java.lang.String&nbsp;keyPassword,
                               java.util.Properties&nbsp;userPassList)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor that initializes a Subject, apart from the keystore and
 truststore.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#authenticateUser(java.lang.String, java.lang.String)">authenticateUser</A></B>(java.lang.String&nbsp;username,
                 java.lang.String&nbsp;password)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Authenticate the user against a list of known username-password
 pairs.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#authenticateUser(java.lang.String, java.lang.String, java.lang.String, java.lang.String)">authenticateUser</A></B>(java.lang.String&nbsp;username,
                 java.lang.String&nbsp;passwordDigest,
                 java.lang.String&nbsp;nonce,
                 java.lang.String&nbsp;created)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Authenticate the user given the password digest.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#checkSubject(javax.security.auth.Subject)">checkSubject</A></B>(javax.security.auth.Subject&nbsp;subject)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Look up each Principal associated with the Subject in a list of 
 authroized principals contained in this SecurityEnvironment</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#finalize()">finalize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getAgreementName(java.lang.String)">getAgreementName</A></B>(java.lang.String&nbsp;agreementProperty)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TODO : remove these once they are handled in SecurityConfiguration
 return the name for any out-of-band agreements between 
 the sender and receiver.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.Object</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getAgreementValue(java.lang.String)">getAgreementValue</A></B>(java.lang.String&nbsp;agreementName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TODO : remove these once they are handled in SecurityConfiguration
 return the value for any out-of-band agreements between 
 the sender and receiver.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.cert.X509Certificate</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getCertificate(java.math.BigInteger, java.lang.String)">getCertificate</A></B>(java.math.BigInteger&nbsp;serialNumber,
               java.lang.String&nbsp;issuerName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.cert.X509Certificate</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getCertificate(java.lang.String)">getCertificate</A></B>(java.lang.String&nbsp;keyIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.cert.X509Certificate</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getCertificate(java.lang.String, boolean)">getCertificate</A></B>(java.lang.String&nbsp;alias,
               boolean&nbsp;forSigning)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.cert.X509Certificate</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getDefaultCertificate()">getDefaultCertificate</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retrieves a reasonable default value for the current user's
 X509Certificate if one exists.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.KeyStore</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getKeyStore()">getKeyStore</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.cert.X509Certificate</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getMatchingCertificate(java.math.BigInteger, java.lang.String)">getMatchingCertificate</A></B>(java.math.BigInteger&nbsp;serialNumber,
                       java.lang.String&nbsp;issuerName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.cert.X509Certificate</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getMatchingCertificate(byte[])">getMatchingCertificate</A></B>(byte[]&nbsp;keyIdMatch)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.PrivateKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getMatchingPrivateKey(java.math.BigInteger, java.lang.String)">getMatchingPrivateKey</A></B>(java.math.BigInteger&nbsp;serialNumberMatch,
                      java.lang.String&nbsp;issuerNameMatch)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.PrivateKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getMatchingPrivateKey(byte[])">getMatchingPrivateKey</A></B>(byte[]&nbsp;keyIdMatch)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.PrivateKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getMatchingPrivateKey(java.security.cert.X509Certificate)">getMatchingPrivateKey</A></B>(java.security.cert.X509Certificate&nbsp;x509CertMatch)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.PrivateKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getPrivateKey(java.math.BigInteger, java.lang.String)">getPrivateKey</A></B>(java.math.BigInteger&nbsp;serialNumber,
              java.lang.String&nbsp;issuerName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.PrivateKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getPrivateKey(byte[])">getPrivateKey</A></B>(byte[]&nbsp;keyIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.PrivateKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getPrivateKey(java.lang.String)">getPrivateKey</A></B>(java.lang.String&nbsp;keyIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.PrivateKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getPrivateKey(java.security.cert.X509Certificate)">getPrivateKey</A></B>(java.security.cert.X509Certificate&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.PublicKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getPublicKey(java.math.BigInteger, java.lang.String)">getPublicKey</A></B>(java.math.BigInteger&nbsp;serialNumber,
             java.lang.String&nbsp;issuerName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.PublicKey</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getPublicKey(java.lang.String)">getPublicKey</A></B>(java.lang.String&nbsp;keyIdentifier)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.Key</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getSecretKey(java.lang.String)">getSecretKey</A></B>(java.lang.String&nbsp;alias)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.Key</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getSessionKey(java.lang.String)">getSessionKey</A></B>(java.lang.String&nbsp;sessionKeyName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TODO: remove this, this is an agreement property
 return the session-key agreed out-of-band (Scenario 4)</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;javax.security.auth.Subject</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getSubject()">getSubject</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.security.KeyStore</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#getTrustStore()">getTrustStore</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#initializeAuthorizedPrincipals(java.util.Vector)">initializeAuthorizedPrincipals</A></B>(java.util.Vector&nbsp;principals)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#initializeSubject(java.lang.String[], java.lang.String[], java.security.KeyStore)">initializeSubject</A></B>(java.lang.String[]&nbsp;aliases,
                  java.lang.String[]&nbsp;keyPasswords,
                  java.security.KeyStore&nbsp;ks)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initialize a Subject using the given credentials</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#initializeUsernamePasswords(java.util.Properties)">initializeUsernamePasswords</A></B>(java.util.Properties&nbsp;usernamePasswordList)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#setAgreementProperty(java.lang.String, java.lang.Object)">setAgreementProperty</A></B>(java.lang.String&nbsp;name,
                     java.lang.Object&nbsp;value)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#setNonceCacheCleanup(boolean)">setNonceCacheCleanup</A></B>(boolean&nbsp;enableStatus)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#updateOtherPartySubject(javax.security.auth.Subject, java.lang.String, java.lang.String)">updateOtherPartySubject</A></B>(javax.security.auth.Subject&nbsp;subject,
                        java.lang.String&nbsp;username,
                        java.lang.String&nbsp;password)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Update the public/private credentials of the subject of the party
 whose username password pair is given.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#updateOtherPartySubject(javax.security.auth.Subject, java.security.cert.X509Certificate)">updateOtherPartySubject</A></B>(javax.security.auth.Subject&nbsp;subject,
                        java.security.cert.X509Certificate&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Update the public/private credentials of the subject of the party
 whose certificate is given.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#validateAndCacheNonce(java.lang.String, java.lang.String)">validateAndCacheNonce</A></B>(java.lang.String&nbsp;nonce,
                      java.lang.String&nbsp;created)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Validate the given nonce.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#validateCertificate(java.security.cert.X509Certificate)">validateCertificate</A></B>(java.security.cert.X509Certificate&nbsp;cert)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Validate an X509Certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.html#validateCreationTime(java.lang.String)">validateCreationTime</A></B>(java.lang.String&nbsp;creationTime)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Validate the creation time.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Field Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="log"><!-- --></A><H3>
log</H3>
<PRE>
protected static java.util.logging.Logger <B>log</B></PRE>
<DL>
<DD>logger
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="TIMESTAMP_FRESHNESS_LIMIT"><!-- --></A><H3>
TIMESTAMP_FRESHNESS_LIMIT</H3>
<PRE>
protected static long <B>TIMESTAMP_FRESHNESS_LIMIT</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
DefaultSecurityEnvironmentImpl</H3>
<PRE>
public <B>DefaultSecurityEnvironmentImpl</B>(java.lang.String&nbsp;truststoreURL,
                                      java.lang.String&nbsp;truststorePassword,
                                      java.lang.String&nbsp;truststoreType)
                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A>,
                                      java.io.IOException,
                                      java.security.PrivilegedActionException</PRE>
<DL>
<DD>Constructor that initializes a Subject using
 AccessController.getContext()
<P>
<DT><B>Parameters:</B><DD><CODE>truststoreURL</CODE> - URL of truststore used for locating trusted certificates of
            other parties<DD><CODE>truststorePassword</CODE> - password for the truststore<DD><CODE>truststoreType</CODE> - </DL>
<HR>

<A NAME="DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String)"><!-- --></A><H3>
DefaultSecurityEnvironmentImpl</H3>
<PRE>
public <B>DefaultSecurityEnvironmentImpl</B>(java.lang.String&nbsp;truststoreURL,
                                      java.lang.String&nbsp;truststorePassword)
                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A>,
                                      java.io.IOException,
                                      java.security.PrivilegedActionException</PRE>
<DL>
<DD>Constructor that initializes a Subject using
 AccessController.getContext().
 Default store-type is used.
<P>
<DT><B>Parameters:</B><DD><CODE>truststoreURL</CODE> - URL of truststore used for locating trusted certificates of
            other parties<DD><CODE>truststorePassword</CODE> - password for the truststore</DL>
<HR>

<A NAME="DefaultSecurityEnvironmentImpl(java.io.InputStream, java.lang.String, java.lang.String)"><!-- --></A><H3>
DefaultSecurityEnvironmentImpl</H3>
<PRE>
public <B>DefaultSecurityEnvironmentImpl</B>(java.io.InputStream&nbsp;trustStoreStream,
                                      java.lang.String&nbsp;truststorePassword,
                                      java.lang.String&nbsp;truststoreType)
                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A>,
                                      java.io.IOException,
                                      java.security.PrivilegedActionException</PRE>
<DL>
<DD>Constructor that initializes a Subject using
 AccessController.getContext()
<P>
<DT><B>Parameters:</B><DD><CODE>truststorePassword</CODE> - password for the truststore<DD><CODE>truststoreType</CODE> - </DL>
<HR>

<A NAME="DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String[], java.lang.String[])"><!-- --></A><H3>
DefaultSecurityEnvironmentImpl</H3>
<PRE>
public <B>DefaultSecurityEnvironmentImpl</B>(java.lang.String&nbsp;keystoreURL,
                                      java.lang.String&nbsp;keystorePassword,
                                      java.lang.String&nbsp;keystoreType,
                                      java.lang.String&nbsp;truststoreURL,
                                      java.lang.String&nbsp;truststorePassword,
                                      java.lang.String&nbsp;truststoreType,
                                      java.lang.String[]&nbsp;aliases,
                                      java.lang.String[]&nbsp;keyPasswords)
                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A>,
                                      java.io.IOException,
                                      java.security.PrivilegedActionException</PRE>
<DL>
<DD>Constructor that initializes a Subject, apart from the keystore and
 truststore
<P>
</DL>
<HR>

<A NAME="DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.util.Properties)"><!-- --></A><H3>
DefaultSecurityEnvironmentImpl</H3>
<PRE>
public <B>DefaultSecurityEnvironmentImpl</B>(java.lang.String&nbsp;keystoreURL,
                                      java.lang.String&nbsp;keystorePassword,
                                      java.lang.String&nbsp;keystoreType,
                                      java.lang.String&nbsp;truststoreURL,
                                      java.lang.String&nbsp;truststorePassword,
                                      java.lang.String&nbsp;truststoreType,
                                      java.lang.String&nbsp;keyPassword,
                                      java.util.Properties&nbsp;userPassList)
                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A>,
                                      java.io.IOException,
                                      java.security.PrivilegedActionException</PRE>
<DL>
<DD>Constructor that initializes a Subject, apart from the keystore and
 truststore.
 This constructor does not take array of aliasis.
 Also a single keypassword is taken as argument.
<P>
</DL>
<HR>

<A NAME="DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String[], java.lang.String[])"><!-- --></A><H3>
DefaultSecurityEnvironmentImpl</H3>
<PRE>
public <B>DefaultSecurityEnvironmentImpl</B>(java.lang.String&nbsp;keystoreURL,
                                      java.lang.String&nbsp;keystorePassword,
                                      java.lang.String&nbsp;truststoreURL,
                                      java.lang.String&nbsp;truststorePassword,
                                      java.lang.String[]&nbsp;aliases,
                                      java.lang.String[]&nbsp;keyPasswords)
                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A>,
                                      java.io.IOException,
                                      java.security.PrivilegedActionException</PRE>
<DL>
<DD>Constructor that initializes a Subject, apart from the keystore and
 truststore.
 Default store-type is used.
<P>
</DL>
<HR>

<A NAME="DefaultSecurityEnvironmentImpl(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
DefaultSecurityEnvironmentImpl</H3>
<PRE>
public <B>DefaultSecurityEnvironmentImpl</B>(java.lang.String&nbsp;keystoreURL,
                                      java.lang.String&nbsp;keystorePassword,
                                      java.lang.String&nbsp;truststoreURL,
                                      java.lang.String&nbsp;truststorePassword,
                                      java.lang.String&nbsp;keyPassword)
                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A>,
                                      java.io.IOException,
                                      java.security.PrivilegedActionException</PRE>
<DL>
<DD>Constructor that initializes a Subject, apart from the keystore and
 truststore.
 Default store-type is used.
 This constructor does not take array of aliasis.
 Also a single keypassword is taken as argument.
<P>
</DL>
<HR>

<A NAME="DefaultSecurityEnvironmentImpl(java.io.InputStream, java.lang.String, java.lang.String, java.io.InputStream, java.lang.String, java.lang.String, java.lang.String[], java.lang.String[])"><!-- --></A><H3>
DefaultSecurityEnvironmentImpl</H3>
<PRE>
public <B>DefaultSecurityEnvironmentImpl</B>(java.io.InputStream&nbsp;keyStoreStream,
                                      java.lang.String&nbsp;keystorePassword,
                                      java.lang.String&nbsp;keystoreType,
                                      java.io.InputStream&nbsp;trustStoreStream,
                                      java.lang.String&nbsp;truststorePassword,
                                      java.lang.String&nbsp;truststoreType,
                                      java.lang.String[]&nbsp;aliases,
                                      java.lang.String[]&nbsp;keyPasswords)
                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A>,
                                      java.io.IOException,
                                      java.security.PrivilegedActionException</PRE>
<DL>
<DD>Constructor that initializes a Subject, apart from the keystore and
 truststore
<P>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="getCertificate(java.math.BigInteger, java.lang.String)"><!-- --></A><H3>
getCertificate</H3>
<PRE>
public java.security.cert.X509Certificate <B>getCertificate</B>(java.math.BigInteger&nbsp;serialNumber,
                                                         java.lang.String&nbsp;issuerName)
                                                  throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getCertificate(java.math.BigInteger, java.lang.String)">getCertificate</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>serialNumber</CODE> - <DD><CODE>issuerName</CODE> - 
<DT><B>Returns:</B><DD>the certificate corresponding to the KeyIdentifier
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getDefaultCertificate()"><!-- --></A><H3>
getDefaultCertificate</H3>
<PRE>
public java.security.cert.X509Certificate <B>getDefaultCertificate</B>()
                                                         throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>Retrieves a reasonable default value for the current user's
 X509Certificate if one exists.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getDefaultCertificate()">getDefaultCertificate</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the default certificate for the current user
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getSecretKey(java.lang.String)"><!-- --></A><H3>
getSecretKey</H3>
<PRE>
public java.security.Key <B>getSecretKey</B>(java.lang.String&nbsp;alias)
                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getSecretKey(java.lang.String)">getSecretKey</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>

<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getCertificate(java.lang.String, boolean)"><!-- --></A><H3>
getCertificate</H3>
<PRE>
public java.security.cert.X509Certificate <B>getCertificate</B>(java.lang.String&nbsp;alias,
                                                         boolean&nbsp;forSigning)
                                                  throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getCertificate(java.lang.String, boolean)">getCertificate</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>forSigning</CODE> - 
<DT><B>Returns:</B><DD>the certificate corresponding to the alias
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getCertificate(java.lang.String)"><!-- --></A><H3>
getCertificate</H3>
<PRE>
public java.security.cert.X509Certificate <B>getCertificate</B>(java.lang.String&nbsp;keyIdentifier)
                                                  throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getCertificate(java.lang.String)">getCertificate</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keyIdentifier</CODE> - an Opaque identifier indicating
            the X509 certificate.
<DT><B>Returns:</B><DD>the certificate corresponding to the KeyIdentifier
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPrivateKey(java.lang.String)"><!-- --></A><H3>
getPrivateKey</H3>
<PRE>
public java.security.PrivateKey <B>getPrivateKey</B>(java.lang.String&nbsp;keyIdentifier)
                                       throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getPrivateKey(java.lang.String)">getPrivateKey</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keyIdentifier</CODE> - an Opaque identifier indicating 
            the X509 certificate.
<DT><B>Returns:</B><DD>the PrivateKey corresponding to a KeyIdentifier
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPrivateKey(byte[])"><!-- --></A><H3>
getPrivateKey</H3>
<PRE>
public java.security.PrivateKey <B>getPrivateKey</B>(byte[]&nbsp;keyIdentifier)
                                       throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getPrivateKey(byte[])">getPrivateKey</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keyIdentifier</CODE> - an Opaque identifier indicating 
            the X509 certificate.
<DT><B>Returns:</B><DD>the PrivateKey corresponding to a KeyIdentifier
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPublicKey(java.lang.String)"><!-- --></A><H3>
getPublicKey</H3>
<PRE>
public java.security.PublicKey <B>getPublicKey</B>(java.lang.String&nbsp;keyIdentifier)
                                     throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getPublicKey(java.lang.String)">getPublicKey</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keyIdentifier</CODE> - an Opaque identifier indicating 
            the X509 certificate.
<DT><B>Returns:</B><DD>the PublicKey corresponding to a KeyIdentifier
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPrivateKey(java.security.cert.X509Certificate)"><!-- --></A><H3>
getPrivateKey</H3>
<PRE>
public java.security.PrivateKey <B>getPrivateKey</B>(java.security.cert.X509Certificate&nbsp;cert)
                                       throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getPrivateKey(java.security.cert.X509Certificate)">getPrivateKey</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cert</CODE> - the X509 certificate.
<DT><B>Returns:</B><DD>the PrivateKey corresponding to X509 certificate
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPrivateKey(java.math.BigInteger, java.lang.String)"><!-- --></A><H3>
getPrivateKey</H3>
<PRE>
public java.security.PrivateKey <B>getPrivateKey</B>(java.math.BigInteger&nbsp;serialNumber,
                                              java.lang.String&nbsp;issuerName)
                                       throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getPrivateKey(java.math.BigInteger, java.lang.String)">getPrivateKey</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>serialNumber</CODE> - <DD><CODE>issuerName</CODE> - 
<DT><B>Returns:</B><DD>the PrivateKey corresponding to (serialNumber, issuerName)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPublicKey(java.math.BigInteger, java.lang.String)"><!-- --></A><H3>
getPublicKey</H3>
<PRE>
public java.security.PublicKey <B>getPublicKey</B>(java.math.BigInteger&nbsp;serialNumber,
                                            java.lang.String&nbsp;issuerName)
                                     throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getPublicKey(java.math.BigInteger, java.lang.String)">getPublicKey</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>serialNumber</CODE> - <DD><CODE>issuerName</CODE> - 
<DT><B>Returns:</B><DD>the PublicKey corresponding to (serialNumber, issuerName)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="authenticateUser(java.lang.String, java.lang.String)"><!-- --></A><H3>
authenticateUser</H3>
<PRE>
public boolean <B>authenticateUser</B>(java.lang.String&nbsp;username,
                                java.lang.String&nbsp;password)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>Authenticate the user against a list of known username-password
 pairs.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#authenticateUser(java.lang.String, java.lang.String)">authenticateUser</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>username</CODE> - <DD><CODE>password</CODE> - 
<DT><B>Returns:</B><DD>true if the username-password pair is valid</DL>
</DD>
</DL>
<HR>

<A NAME="authenticateUser(java.lang.String, java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
authenticateUser</H3>
<PRE>
public boolean <B>authenticateUser</B>(java.lang.String&nbsp;username,
                                java.lang.String&nbsp;passwordDigest,
                                java.lang.String&nbsp;nonce,
                                java.lang.String&nbsp;created)
                         throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>Authenticate the user given the password digest.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#authenticateUser(java.lang.String, java.lang.String, java.lang.String, java.lang.String)">authenticateUser</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>username</CODE> - <DD><CODE>passwordDigest</CODE> - <DD><CODE>nonce</CODE> - <DD><CODE>created</CODE> - 
<DT><B>Returns:</B><DD>true if the password digest is valid
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkSubject(javax.security.auth.Subject)"><!-- --></A><H3>
checkSubject</H3>
<PRE>
public boolean <B>checkSubject</B>(javax.security.auth.Subject&nbsp;subject)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>Look up each Principal associated with the Subject in a list of 
 authroized principals contained in this SecurityEnvironment
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#checkSubject(javax.security.auth.Subject)">checkSubject</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>subject</CODE> - the subject to be authorized/checked
<DT><B>Returns:</B><DD>true if the subject is authorized, false otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="getSubject()"><!-- --></A><H3>
getSubject</H3>
<PRE>
public javax.security.auth.Subject <B>getSubject</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getSubject()">getSubject</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>return the host/sender Subject, 
    null if subject not available/initialized</DL>
</DD>
</DL>
<HR>

<A NAME="initializeSubject(java.lang.String[], java.lang.String[], java.security.KeyStore)"><!-- --></A><H3>
initializeSubject</H3>
<PRE>
public void <B>initializeSubject</B>(java.lang.String[]&nbsp;aliases,
                              java.lang.String[]&nbsp;keyPasswords,
                              java.security.KeyStore&nbsp;ks)
                       throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD>Initialize a Subject using the given credentials
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>aliases</CODE> - the list of aliases<DD><CODE>keyPasswords</CODE> - the key passwords corresponding to aliases<DD><CODE>ks</CODE> - the KeyStore in which the aliases are present
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE> - any other processing error</DL>
</DD>
</DL>
<HR>

<A NAME="initializeUsernamePasswords(java.util.Properties)"><!-- --></A><H3>
initializeUsernamePasswords</H3>
<PRE>
public void <B>initializeUsernamePasswords</B>(java.util.Properties&nbsp;usernamePasswordList)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="initializeAuthorizedPrincipals(java.util.Vector)"><!-- --></A><H3>
initializeAuthorizedPrincipals</H3>
<PRE>
public void <B>initializeAuthorizedPrincipals</B>(java.util.Vector&nbsp;principals)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setAgreementProperty(java.lang.String, java.lang.Object)"><!-- --></A><H3>
setAgreementProperty</H3>
<PRE>
public void <B>setAgreementProperty</B>(java.lang.String&nbsp;name,
                                 java.lang.Object&nbsp;value)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getKeyStore()"><!-- --></A><H3>
getKeyStore</H3>
<PRE>
public java.security.KeyStore <B>getKeyStore</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getTrustStore()"><!-- --></A><H3>
getTrustStore</H3>
<PRE>
public java.security.KeyStore <B>getTrustStore</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getSessionKey(java.lang.String)"><!-- --></A><H3>
getSessionKey</H3>
<PRE>
public java.security.Key <B>getSessionKey</B>(java.lang.String&nbsp;sessionKeyName)
                                throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>TODO: remove this, this is an agreement property
 return the session-key agreed out-of-band (Scenario 4)
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getSessionKey(java.lang.String)">getSessionKey</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sessionKeyName</CODE> - the name that identifies the session key
<DT><B>Returns:</B><DD>the Key, or null if the sessionKeyName is invalid.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getAgreementName(java.lang.String)"><!-- --></A><H3>
getAgreementName</H3>
<PRE>
public java.lang.String <B>getAgreementName</B>(java.lang.String&nbsp;agreementProperty)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>TODO : remove these once they are handled in SecurityConfiguration
 return the name for any out-of-band agreements between 
 the sender and receiver. This method provides a way for the rest 
 of the application to access it. 
 Implementing classes are supposed to return appropriate names for 
 the properties that identify an agreement.
 The Interop Scenarios describe the following agreements :
 1. Username-Password-List (Scenario 2).
 2. CERT-VALUE (Scenario 2, 3, 4)
 3. Signature-Trust-Root (Scenario 3)
 4. Session-Key-Value (Scenario 4)
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getAgreementName(java.lang.String)">getAgreementName</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>agreementProperty</CODE> - the property that identifes the agreement.
<DT><B>Returns:</B><DD>the name of the agreement, if the property is valid, 
         null otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="getAgreementValue(java.lang.String)"><!-- --></A><H3>
getAgreementValue</H3>
<PRE>
public java.lang.Object <B>getAgreementValue</B>(java.lang.String&nbsp;agreementName)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>TODO : remove these once they are handled in SecurityConfiguration
 return the value for any out-of-band agreements between 
 the sender and receiver. This method provides a way for the rest 
 of the application to access it. 
 Implementing classes are supposed to return appropriate values for 
 the agreement names that identify an agreement.
 The Interop Scenarios describe the following agreements :
 1. Username-Password-List (Scenario 2).
 2. CERT-VALUE (Scenario 2, 3, 4)
 3. Signature-Trust-Root (Scenario 3)
 4. Session-Key-Value (Scenario 4)
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#getAgreementValue(java.lang.String)">getAgreementValue</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>agreementName</CODE> - the name/key of the agreement.
<DT><B>Returns:</B><DD>the value of the agreement, if the name is valid, 
         null otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="setNonceCacheCleanup(boolean)"><!-- --></A><H3>
setNonceCacheCleanup</H3>
<PRE>
public void <B>setNonceCacheCleanup</B>(boolean&nbsp;enableStatus)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getMatchingPrivateKey(byte[])"><!-- --></A><H3>
getMatchingPrivateKey</H3>
<PRE>
public java.security.PrivateKey <B>getMatchingPrivateKey</B>(byte[]&nbsp;keyIdMatch)
                                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keyIdMatch</CODE> - KeyIdentifier to search for
<DT><B>Returns:</B><DD>the matching PrivateKey or null if not found
<DT><B>Throws:</B>
<DD><CODE>java.security.KeyStoreException</CODE>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE>
<DD><CODE>java.security.UnrecoverableKeyException</CODE>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getMatchingCertificate(byte[])"><!-- --></A><H3>
getMatchingCertificate</H3>
<PRE>
public java.security.cert.X509Certificate <B>getMatchingCertificate</B>(byte[]&nbsp;keyIdMatch)
                                                          throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>keyIdMatch</CODE> - KeyIdentifier to search for
<DT><B>Returns:</B><DD>the matching Certificate or null if not found
<DT><B>Throws:</B>
<DD><CODE>java.security.KeyStoreException</CODE>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE>
<DD><CODE>java.security.UnrecoverableKeyException</CODE>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getMatchingCertificate(java.math.BigInteger, java.lang.String)"><!-- --></A><H3>
getMatchingCertificate</H3>
<PRE>
public java.security.cert.X509Certificate <B>getMatchingCertificate</B>(java.math.BigInteger&nbsp;serialNumber,
                                                                 java.lang.String&nbsp;issuerName)
                                                          throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getMatchingPrivateKey(java.math.BigInteger, java.lang.String)"><!-- --></A><H3>
getMatchingPrivateKey</H3>
<PRE>
public java.security.PrivateKey <B>getMatchingPrivateKey</B>(java.math.BigInteger&nbsp;serialNumberMatch,
                                                      java.lang.String&nbsp;issuerNameMatch)
                                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>serialNumberMatch</CODE> - <DD><CODE>issuerNameMatch</CODE> - 
<DT><B>Returns:</B><DD>the matching PrivateKey or null if not found
<DT><B>Throws:</B>
<DD><CODE>java.security.KeyStoreException</CODE>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE>
<DD><CODE>java.security.UnrecoverableKeyException</CODE>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getMatchingPrivateKey(java.security.cert.X509Certificate)"><!-- --></A><H3>
getMatchingPrivateKey</H3>
<PRE>
public java.security.PrivateKey <B>getMatchingPrivateKey</B>(java.security.cert.X509Certificate&nbsp;x509CertMatch)
                                               throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>x509CertMatch</CODE> - 
<DT><B>Returns:</B><DD>the matching PrivateKey or null if not found
<DT><B>Throws:</B>
<DD><CODE>java.security.KeyStoreException</CODE>
<DD><CODE>java.security.NoSuchAlgorithmException</CODE>
<DD><CODE>java.security.UnrecoverableKeyException</CODE>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="validateAndCacheNonce(java.lang.String, java.lang.String)"><!-- --></A><H3>
validateAndCacheNonce</H3>
<PRE>
public boolean <B>validateAndCacheNonce</B>(java.lang.String&nbsp;nonce,
                                     java.lang.String&nbsp;created)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>Validate the given nonce. It is an error if the nonce matches any
 stored nonce values on the server
 if there is no error then the nonce is Cached.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#validateAndCacheNonce(java.lang.String, java.lang.String)">validateAndCacheNonce</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nonce</CODE> - the encoded nonce value<DD><CODE>created</CODE> - the creation time value
<DT><B>Returns:</B><DD>true if this nonce is valid</DL>
</DD>
</DL>
<HR>

<A NAME="validateCreationTime(java.lang.String)"><!-- --></A><H3>
validateCreationTime</H3>
<PRE>
public boolean <B>validateCreationTime</B>(java.lang.String&nbsp;creationTime)
                             throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>Validate the creation time. it is an error if the
 creation time is older than current local time minus 
 MAX_NONCE_AGE minus MAX_CLOCK_SKEW
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#validateCreationTime(java.lang.String)">validateCreationTime</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>creationTime</CODE> - the creation-time value
<DT><B>Returns:</B><DD>true if this nonce is valid
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="validateCertificate(java.security.cert.X509Certificate)"><!-- --></A><H3>
validateCertificate</H3>
<PRE>
public boolean <B>validateCertificate</B>(java.security.cert.X509Certificate&nbsp;cert)
                            throws <A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>Validate an X509Certificate.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#validateCertificate(java.security.cert.X509Certificate)">validateCertificate</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>true, if the cert is a valid one, false o/w.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/sun/xml/wss/XWSSecurityException.html">XWSSecurityException</A></CODE> - if there is some problem during validation.</DL>
</DD>
</DL>
<HR>

<A NAME="updateOtherPartySubject(javax.security.auth.Subject, java.lang.String, java.lang.String)"><!-- --></A><H3>
updateOtherPartySubject</H3>
<PRE>
public void <B>updateOtherPartySubject</B>(javax.security.auth.Subject&nbsp;subject,
                                    java.lang.String&nbsp;username,
                                    java.lang.String&nbsp;password)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>Update the public/private credentials of the subject of the party
 whose username password pair is given.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#updateOtherPartySubject(javax.security.auth.Subject, java.lang.String, java.lang.String)">updateOtherPartySubject</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="updateOtherPartySubject(javax.security.auth.Subject, java.security.cert.X509Certificate)"><!-- --></A><H3>
updateOtherPartySubject</H3>
<PRE>
public void <B>updateOtherPartySubject</B>(javax.security.auth.Subject&nbsp;subject,
                                    java.security.cert.X509Certificate&nbsp;cert)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></B></DD>
<DD>Update the public/private credentials of the subject of the party
 whose certificate is given.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html#updateOtherPartySubject(javax.security.auth.Subject, java.security.cert.X509Certificate)">updateOtherPartySubject</A></CODE> in interface <CODE><A HREF="../../../../../com/sun/xml/wss/SecurityEnvironment.html">SecurityEnvironment</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="finalize()"><!-- --></A><H3>
finalize</H3>
<PRE>
protected void <B>finalize</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>finalize</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/sun/xml/wss/impl/ContainerSecurityEnvironment.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/sun/xml/wss/impl/DefaultSecurityEnvironmentImpl.NonceReclaimer.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="DefaultSecurityEnvironmentImpl.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../../../../../allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
Copyright ? 2004 Sun Microsystems, Inc. All Rights Reserved.
</BODY>
</HTML>
